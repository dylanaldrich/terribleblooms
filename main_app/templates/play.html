{% extends "index.html" %}
{% load static %}
{% load cloudinary %}
{% load quill_filters %}
{% block content %}
<section class="play-detail-page inner">
  <script type="text/javascript">
    var mobileImageUrl = "{% static 'assets/artwork/thereordering_cassietaggart_mobile.jpg' %}";
    var desktopImageUrl = "{% static 'assets/artwork/thereordering_cassietaggart.jpg' %}";
  </script>
  <script type="text/javascript">
    // load mobile/full resolution artwork
    if ($(window).width() <= 450) {
      $("#reordering").attr(
        "src",
        mobileImageUrl
      );
    } else {
      $("#reordering").attr(
        "src",
        desktopImageUrl
      );
    }
  </script>
  <img
    src="{% static 'assets/artwork/thereordering_cassietaggart.jpg' %}"
    alt="Background artwork: The Reordering by Cassie Taggart"
    class="side-image z-depth-2"
    id="reordering"
  />
  <div class="play-detail-container">
    <div id="play">
      <h2>{{ play.name }}</h2>
      <p>Released: {{play.release_Date|date:"F j, Y"}}</p>
      <div class="play-description">{{ play.description|quill_html }}</div>
      <p class="byline">Written and Directed by Sharon Yablon</p>
      <section class="audio">
        <audio controls aria-label="Audio player for {{ play.name }}">
          <source src="{{ play.audioFile.url }}" type="audio/mpeg" />
          Your browser does not support the audio element.
        </audio>
        <div class="logos">
          <section id="logo-cover">
            <i class="fas fa-hand-point-right" aria-hidden="true"></i>
            <span>Subscribe</span>
          </section>
          <a
            href="https://apple.co/38uRiUn"
            rel="noopener"
            target="_blank"
            id="apple-podcast-logo"
            title="Apple Podcasts"
            aria-label="Subscribe on Apple Podcasts"
          >
            <i class="fas fa-podcast" aria-hidden="true"></i>
            <span>Apple</span>
          </a>
          <a
            href="https://music.amazon.com/podcasts/A-Garden-of-Terrible-Blooms"
            rel="noopener"
            target="_blank"
            id="amazon-podcast-logo"
            title="Amazon Podcasts"
            aria-label="Subscribe on Amazon Podcasts"
          >
            <i class="fab fa-amazon" aria-hidden="true"></i>
            <span>Amazon</span>
          </a>
          <a
            href="https://open.spotify.com/show/a-garden-of-terrible-blooms"
            rel="noopener"
            target="_blank"
            id="spotify-podcast-logo"
            title="Spotify Podcasts"
            aria-label="Subscribe on Spotify"
          >
            <i class="fab fa-spotify" aria-hidden="true"></i>
            <span>Spotify</span>
          </a>
        </div>
        <div class="share">
          <span>Share:</span>
        </div>
      </section>
      <div class="meet-the-performers">
        <hr />
        <h3>Meet The Performers:</h3>
        <div id="performer-link-container">
          {% for performer in play.performers.all %}
          <a
            href="{% url 'artists' %}#{{ performer.name }}"
            class="performer-link hoverable"
            >{{ performer.name }}</a
          >
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</section>

<script type="text/javascript">
  window.addEventListener("resize", () => {
    // moves ascap text && wraps elements in new container
    if ($(window).width() <= 827 && $(window).width() >= 788) {
      $(".play-detail-page").after($("#ascap"));
      if (!$(".inner").parent().hasClass("episode-page-wrapper")) {
        $(".inner").wrapAll('<div class="episode-page-wrapper" />');
        $(".episode-page-wrapper").css("height", "100%");
      }
    } else {
      $(".episode-page-wrapper").replaceWith(
        $(".episode-page-wrapper").contents()
      );
    }
  });
</script>

<script type="text/javascript">
  // keeps play detail page the same width as the navbar
  let $width = $("nav").width();
  $(".play-detail-page").css("width", $width + "px");

  window.addEventListener("resize", () => {
    $width = $("nav").width();
    $(".play-detail-page").css("width", $width + "px");
  });
</script>
{% endblock %}
